{"version":3,"file":"gawd-player.esm.min.js","sources":["../node_modules/detect-browser/es/index.js","../src/components/player.ts"],"sourcesContent":["var __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nvar BrowserInfo = /** @class */ (function () {\n    function BrowserInfo(name, version, os) {\n        this.name = name;\n        this.version = version;\n        this.os = os;\n        this.type = 'browser';\n    }\n    return BrowserInfo;\n}());\nexport { BrowserInfo };\nvar NodeInfo = /** @class */ (function () {\n    function NodeInfo(version) {\n        this.version = version;\n        this.type = 'node';\n        this.name = 'node';\n        this.os = process.platform;\n    }\n    return NodeInfo;\n}());\nexport { NodeInfo };\nvar SearchBotDeviceInfo = /** @class */ (function () {\n    function SearchBotDeviceInfo(name, version, os, bot) {\n        this.name = name;\n        this.version = version;\n        this.os = os;\n        this.bot = bot;\n        this.type = 'bot-device';\n    }\n    return SearchBotDeviceInfo;\n}());\nexport { SearchBotDeviceInfo };\nvar BotInfo = /** @class */ (function () {\n    function BotInfo() {\n        this.type = 'bot';\n        this.bot = true; // NOTE: deprecated test name instead\n        this.name = 'bot';\n        this.version = null;\n        this.os = null;\n    }\n    return BotInfo;\n}());\nexport { BotInfo };\nvar ReactNativeInfo = /** @class */ (function () {\n    function ReactNativeInfo() {\n        this.type = 'react-native';\n        this.name = 'react-native';\n        this.version = null;\n        this.os = null;\n    }\n    return ReactNativeInfo;\n}());\nexport { ReactNativeInfo };\n// tslint:disable-next-line:max-line-length\nvar SEARCHBOX_UA_REGEX = /alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/;\nvar SEARCHBOT_OS_REGEX = /(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\\ Jeeves\\/Teoma|ia_archiver)/;\nvar REQUIRED_VERSION_PARTS = 3;\nvar userAgentRules = [\n    ['aol', /AOLShield\\/([0-9\\._]+)/],\n    ['edge', /Edge\\/([0-9\\._]+)/],\n    ['edge-ios', /EdgiOS\\/([0-9\\._]+)/],\n    ['yandexbrowser', /YaBrowser\\/([0-9\\._]+)/],\n    ['kakaotalk', /KAKAOTALK\\s([0-9\\.]+)/],\n    ['samsung', /SamsungBrowser\\/([0-9\\.]+)/],\n    ['silk', /\\bSilk\\/([0-9._-]+)\\b/],\n    ['miui', /MiuiBrowser\\/([0-9\\.]+)$/],\n    ['beaker', /BeakerBrowser\\/([0-9\\.]+)/],\n    ['edge-chromium', /EdgA?\\/([0-9\\.]+)/],\n    [\n        'chromium-webview',\n        /(?!Chrom.*OPR)wv\\).*Chrom(?:e|ium)\\/([0-9\\.]+)(:?\\s|$)/,\n    ],\n    ['chrome', /(?!Chrom.*OPR)Chrom(?:e|ium)\\/([0-9\\.]+)(:?\\s|$)/],\n    ['phantomjs', /PhantomJS\\/([0-9\\.]+)(:?\\s|$)/],\n    ['crios', /CriOS\\/([0-9\\.]+)(:?\\s|$)/],\n    ['firefox', /Firefox\\/([0-9\\.]+)(?:\\s|$)/],\n    ['fxios', /FxiOS\\/([0-9\\.]+)/],\n    ['opera-mini', /Opera Mini.*Version\\/([0-9\\.]+)/],\n    ['opera', /Opera\\/([0-9\\.]+)(?:\\s|$)/],\n    ['opera', /OPR\\/([0-9\\.]+)(:?\\s|$)/],\n    ['ie', /Trident\\/7\\.0.*rv\\:([0-9\\.]+).*\\).*Gecko$/],\n    ['ie', /MSIE\\s([0-9\\.]+);.*Trident\\/[4-7].0/],\n    ['ie', /MSIE\\s(7\\.0)/],\n    ['bb10', /BB10;\\sTouch.*Version\\/([0-9\\.]+)/],\n    ['android', /Android\\s([0-9\\.]+)/],\n    ['ios', /Version\\/([0-9\\._]+).*Mobile.*Safari.*/],\n    ['safari', /Version\\/([0-9\\._]+).*Safari/],\n    ['facebook', /FBAV\\/([0-9\\.]+)/],\n    ['instagram', /Instagram\\s([0-9\\.]+)/],\n    ['ios-webview', /AppleWebKit\\/([0-9\\.]+).*Mobile/],\n    ['ios-webview', /AppleWebKit\\/([0-9\\.]+).*Gecko\\)$/],\n    ['searchbot', SEARCHBOX_UA_REGEX],\n];\nvar operatingSystemRules = [\n    ['iOS', /iP(hone|od|ad)/],\n    ['Android OS', /Android/],\n    ['BlackBerry OS', /BlackBerry|BB10/],\n    ['Windows Mobile', /IEMobile/],\n    ['Amazon OS', /Kindle/],\n    ['Windows 3.11', /Win16/],\n    ['Windows 95', /(Windows 95)|(Win95)|(Windows_95)/],\n    ['Windows 98', /(Windows 98)|(Win98)/],\n    ['Windows 2000', /(Windows NT 5.0)|(Windows 2000)/],\n    ['Windows XP', /(Windows NT 5.1)|(Windows XP)/],\n    ['Windows Server 2003', /(Windows NT 5.2)/],\n    ['Windows Vista', /(Windows NT 6.0)/],\n    ['Windows 7', /(Windows NT 6.1)/],\n    ['Windows 8', /(Windows NT 6.2)/],\n    ['Windows 8.1', /(Windows NT 6.3)/],\n    ['Windows 10', /(Windows NT 10.0)/],\n    ['Windows ME', /Windows ME/],\n    ['Open BSD', /OpenBSD/],\n    ['Sun OS', /SunOS/],\n    ['Chrome OS', /CrOS/],\n    ['Linux', /(Linux)|(X11)/],\n    ['Mac OS', /(Mac_PowerPC)|(Macintosh)/],\n    ['QNX', /QNX/],\n    ['BeOS', /BeOS/],\n    ['OS/2', /OS\\/2/],\n];\nexport function detect(userAgent) {\n    if (!!userAgent) {\n        return parseUserAgent(userAgent);\n    }\n    if (typeof document === 'undefined' &&\n        typeof navigator !== 'undefined' &&\n        navigator.product === 'ReactNative') {\n        return new ReactNativeInfo();\n    }\n    if (typeof navigator !== 'undefined') {\n        return parseUserAgent(navigator.userAgent);\n    }\n    return getNodeVersion();\n}\nfunction matchUserAgent(ua) {\n    // opted for using reduce here rather than Array#first with a regex.test call\n    // this is primarily because using the reduce we only perform the regex\n    // execution once rather than once for the test and for the exec again below\n    // probably something that needs to be benchmarked though\n    return (ua !== '' &&\n        userAgentRules.reduce(function (matched, _a) {\n            var browser = _a[0], regex = _a[1];\n            if (matched) {\n                return matched;\n            }\n            var uaMatch = regex.exec(ua);\n            return !!uaMatch && [browser, uaMatch];\n        }, false));\n}\nexport function browserName(ua) {\n    var data = matchUserAgent(ua);\n    return data ? data[0] : null;\n}\nexport function parseUserAgent(ua) {\n    var matchedRule = matchUserAgent(ua);\n    if (!matchedRule) {\n        return null;\n    }\n    var name = matchedRule[0], match = matchedRule[1];\n    if (name === 'searchbot') {\n        return new BotInfo();\n    }\n    var versionParts = match[1] && match[1].split(/[._]/).slice(0, 3);\n    if (versionParts) {\n        if (versionParts.length < REQUIRED_VERSION_PARTS) {\n            versionParts = __spreadArrays(versionParts, createVersionParts(REQUIRED_VERSION_PARTS - versionParts.length));\n        }\n    }\n    else {\n        versionParts = [];\n    }\n    var version = versionParts.join('.');\n    var os = detectOS(ua);\n    var searchBotMatch = SEARCHBOT_OS_REGEX.exec(ua);\n    if (searchBotMatch && searchBotMatch[1]) {\n        return new SearchBotDeviceInfo(name, version, os, searchBotMatch[1]);\n    }\n    return new BrowserInfo(name, version, os);\n}\nexport function detectOS(ua) {\n    for (var ii = 0, count = operatingSystemRules.length; ii < count; ii++) {\n        var _a = operatingSystemRules[ii], os = _a[0], regex = _a[1];\n        var match = regex.exec(ua);\n        if (match) {\n            return os;\n        }\n    }\n    return null;\n}\nexport function getNodeVersion() {\n    var isNode = typeof process !== 'undefined' && process.version;\n    return isNode ? new NodeInfo(process.version.slice(1)) : null;\n}\nfunction createVersionParts(count) {\n    var output = [];\n    for (var ii = 0; ii < count; ii++) {\n        output.push('0');\n    }\n    return output;\n}\n","import { SpatialType, StereoMode, SpatialPlayer, QuiltConfig, SpatialProps } from './spatial-viewer'\nimport { WebGLRenderer, PerspectiveCamera, Scene, TextureLoader, Texture, VideoTexture } from './three'\nimport { detect } from 'detect-browser';\nimport { Clock } from 'three';\nimport { PlayerProps } from '..';\n\nclass Props {\n  public url: string\n  public container: HTMLElement\n  public enableMouseMove: Boolean = true\n  public defaultAsset: GawdAsset = new GawdAsset()\n  public defaultMobileAsset: GawdAsset = new GawdAsset()\n  public spatialProps: SpatialProps = new SpatialProps()\n}\n\nclass Gawd {\n  public name: string\n  public hash: string\n  public assets: Array<GawdAsset>\n}\n\nclass GawdAsset {\n  public url: string\n  public spatial: string\n  public quilt: GawdQuilt\n  public quiltType: string\n  public size: Resolution\n  public viewSize: Resolution\n  public contentType: string\n}\n\nclass GawdQuilt {\n  public columns: number\n  public rows: number\n}\n\nclass Resolution {\n  public width: number\n  public height: number\n}\n\nexport { Props as PlayerProps, Gawd, GawdAsset, GawdQuilt, Resolution }\n\nexport default class Player {\n\n  private _props: Props = new Props()\n  private scene: Scene\n  private renderer: WebGLRenderer\n  private spatialPlayer: SpatialPlayer\n  private camera: PerspectiveCamera\n  private clock: Clock\n  private gawd: Gawd\n\n  // Animation\n  private startAngle: number = 0\n  private targetAngle: number = 0\n  private totalAngles: number = 0\n  private aniCurTime: number = 0\n  private aniDuration: number = 0.5\n\n  constructor(props?: Props) {\n    // Defaults\n    this._props.spatialProps.spatialType = SpatialType.LOOKING_GLASS\n    this._props.spatialProps.stereoMode  = StereoMode.OFF\n\n    // Default desktop asset\n    this._props.defaultAsset.spatial = 'lookingglass'\n    this._props.defaultAsset.quiltType = 'FourKSquare'\n    this._props.defaultAsset.size = new Resolution()\n    this._props.defaultAsset.size.width = 4320\n    this._props.defaultAsset.contentType = 'image/png'\n\n    // Default mobile asset\n    this._props.defaultMobileAsset.spatial = '2d'\n    this._props.defaultMobileAsset.size = new Resolution()\n    this._props.defaultMobileAsset.size.width = 1080\n    this._props.defaultMobileAsset.contentType = 'video/mp4'\n\n    this.setProps(this._props, props)\n\n    this.clock = new Clock();\n\n    if (this._props.container) {\n      this.initThree()\n    }\n    else {\n      console.warn(`No container was set`)\n      return;\n    }\n\n    if (this._props.url) {\n      this.loadGawdConfig(this._props.url).then(data => {\n        this.initGawd(data)\n      });\n    }\n  }\n\n  private setProps(playerProps: Props, userProps?: object): void {\n    if (!userProps) return\n\n    for (let prop in userProps) {\n      if (prop in playerProps) {\n        playerProps[prop] = userProps[prop]\n      } else {\n        console.warn(\n          `GawdViewer: Provided ${prop} in config but it is not a valid property and will be ignored`,\n        )\n      }\n    }\n  }\n  \n  private initThree(): void {\n    this.scene = new Scene();\n\n    this.renderer = new WebGLRenderer({ antialias: true });\n    this.renderer.setSize(this._props.container.clientWidth, this._props.container.clientHeight);\n    this.renderer.xr.enabled = false;\n    this._props.container.appendChild(this.renderer.domElement);\n\n    this.camera = new PerspectiveCamera(90, this.aspectRatio, 0.01, 1000);\n    this.camera.position\n\n    this.scene.add(this.camera);\n\n    this.camera.position.z = 10;\n\n    this.renderer.setAnimationLoop(() => {\n      this.render()\n    });\n\n    window.addEventListener('resize', ev => {\n      this.camera.aspect = this.aspectRatio\n      this.camera.updateProjectionMatrix()\n      this.renderer.setSize(this._props.container.clientWidth, this._props.container.clientHeight)\n    })\n  }\n\n  private initGawd(gawd: Gawd): void {\n    this.gawd = gawd\n\n    const result = detect()\n    let lkgAsset: GawdAsset = null;\n\n    if (result.os.match(/iOS|android/i)) {\n      // Default mobile asset \n      lkgAsset = gawd.assets.filter(a => \n        a.spatial == this._props.defaultMobileAsset.spatial && \n        a.size.width == this._props.defaultMobileAsset.size.width && \n        (a.quiltType == this._props.defaultMobileAsset.quiltType || !this._props.defaultMobileAsset.quiltType)  && \n        a.contentType == this._props.defaultMobileAsset.contentType)[0]\n      \n      if (lkgAsset) {\n        this.initMedia(lkgAsset)\n        return\n      }\n    }\n    \n    // Default desktop asset \n    lkgAsset = gawd.assets.filter(a => \n      a.spatial == this._props.defaultAsset.spatial && \n      a.size.width == this._props.defaultAsset.size.width && \n      (a.quiltType == this._props.defaultAsset.quiltType || !this._props.defaultAsset.quiltType)  && \n      a.contentType == this._props.defaultAsset.contentType )[0]\n    this.initMedia(lkgAsset)\n  }\n\n  private initMedia(asset: GawdAsset): void {\n    if (!asset) {\n      console.warn(\"No GawdAsset found!\");\n      return\n    }\n\n    if (asset.contentType == \"image/png\") {\n      const loader = new TextureLoader()\n      loader.load(asset.url, function (tex) {\n        this.loadSpatialPlayer(tex, asset)\n      }.bind(this))\n    }\n    else if (asset.contentType == 'video/mp4') {\n      const videoId = \"gawd-video-\" + this.gawd.hash\n      let video = document.getElementById(videoId) as HTMLVideoElement\n\n      if (!video)\n      {\n        video = document.createElement('video') as HTMLVideoElement\n        video.id = videoId\n        video.src = asset.url\n        video.crossOrigin = \"anonymous\"\n        video.muted = true\n        video.autoplay = true\n        video.loop = true\n        video.playsInline = true\n        video.style.display = \"none\"\n        document.body.appendChild(video);\n        video.play();\n      }\n        \n      const videoTex = new VideoTexture(video);\n      this.loadSpatialPlayer(videoTex, asset)\n    }\n  }\n\n  private loadSpatialPlayer(texture: Texture, asset: GawdAsset): void {\n    let config = new QuiltConfig();\n\n    if (asset.quilt)\n    {\n      config.columns = asset.quilt.columns > 0 ? asset.quilt.columns : 8\n      config.rows = asset.quilt.rows > 0 ? asset.quilt.rows : 6\n      config.width = asset.viewSize.width > 0 ? asset.viewSize.width : 480\n      config.height = asset.viewSize.height > 0 ? asset.viewSize.height : 640\n    }\n    else\n    {\n      // disable quilt \n      config.columns = 1\n      config.rows = 1\n      config.width = asset.size.width\n      config.height = asset.size.height\n      this._props.enableMouseMove = false\n    }\n\n    this._props.spatialProps.quilt = config\n\n    this.spatialPlayer = new SpatialPlayer(texture, null, this._props.spatialProps)\n    this.totalAngles = this.spatialPlayer.quiltColumns * this.spatialPlayer.quiltRows\n\n    this.scene.add(this.spatialPlayer)\n\n    let dist = this.camera.position.z - this.spatialPlayer.position.z\n    let height = this.aspectRatio; // desired height to fit WHY IS THIS CALLED HEIGHT?\n    this.camera.fov = Math.atan(height / dist) * (180 / Math.PI)\n    this.camera.updateProjectionMatrix();\n\n    if (this._props.enableMouseMove) {\n      window.addEventListener('mousemove', this.onMouseMove.bind(this))\n    }\n  }\n\n  private async loadGawdConfig(url: string): Promise<any> {\n    const response = await fetch(url)\n    return await response.json()\n  }\n\n  private onMouseMove(e: MouseEvent): void {\n    if (this.spatialPlayer) {\n      this.targetAngle = (1 - (e.clientX / window.innerWidth)) * (this.totalAngles - 1)\n      this.startAngle = this.spatialPlayer.quiltAngle\n      this.aniCurTime = 0\n    }\n  }\n  \n  private render(): void {\n    if (this._props.enableMouseMove)\n    {\n      this.aniCurTime += this.clock.getDelta()\n\n      if (this.spatialPlayer && this.aniCurTime / this.aniDuration <= 1) {\n        this.spatialPlayer.quiltAngle = Math.round(this.lerp(\n          this.startAngle, \n          this.targetAngle,\n          this.EasingFunctions.easeOutCubic(this.aniCurTime / this.aniDuration)\n        ))\n      }\n    }\n    \n    this.renderer.render(this.scene, this.camera)\n  }\n\n  private lerp(value1: number, value2: number, amount: number) {\n    amount = amount < 0 ? 0 : amount;\n    amount = amount > 1 ? 1 : amount;\n    return value1 + (value2 - value1) * amount;\n  }\n\n  public get aspectRatio(): number {\n    return this._props.container.clientWidth / this._props.container.clientHeight\n  }\n\n  public get props(): PlayerProps {\n    return this._props\n  }\n\n  EasingFunctions = {\n    // no easing, no acceleration\n    linear: t => t,\n    // accelerating from zero velocity\n    easeInQuad: t => t*t,\n    // decelerating to zero velocity\n    easeOutQuad: t => t*(2-t),\n    // acceleration until halfway, then deceleration\n    easeInOutQuad: t => t<.5 ? 2*t*t : -1+(4-2*t)*t,\n    // accelerating from zero velocity \n    easeInCubic: t => t*t*t,\n    // decelerating to zero velocity \n    easeOutCubic: t => (--t)*t*t+1,\n    // acceleration until halfway, then deceleration \n    easeInOutCubic: t => t<.5 ? 4*t*t*t : (t-1)*(2*t-2)*(2*t-2)+1,\n    // accelerating from zero velocity \n    easeInQuart: t => t*t*t*t,\n    // decelerating to zero velocity \n    easeOutQuart: t => 1-(--t)*t*t*t,\n    // acceleration until halfway, then deceleration\n    easeInOutQuart: t => t<.5 ? 8*t*t*t*t : 1-8*(--t)*t*t*t,\n    // accelerating from zero velocity\n    easeInQuint: t => t*t*t*t*t,\n    // decelerating to zero velocity\n    easeOutQuint: t => 1+(--t)*t*t*t*t,\n    // acceleration until halfway, then deceleration \n    easeInOutQuint: t => t<.5 ? 16*t*t*t*t*t : 1+16*(--t)*t*t*t*t\n  }\n}\n"],"names":["__spreadArrays","s","i","il","arguments","length","r","Array","k","a","j","jl","BrowserInfo","name","version","os","this","type","NodeInfo","process","platform","SearchBotDeviceInfo","bot","BotInfo","ReactNativeInfo","SEARCHBOT_OS_REGEX","userAgentRules","operatingSystemRules","detect","userAgent","parseUserAgent","document","navigator","product","slice","ua","matchedRule","reduce","matched","_a","browser","regex","uaMatch","exec","matchUserAgent","match","versionParts","split","count","output","ii","push","createVersionParts","join","detectOS","searchBotMatch","Props","url","container","enableMouseMove","defaultAsset","GawdAsset","defaultMobileAsset","spatialProps","SpatialProps","Gawd","hash","assets","spatial","quilt","quiltType","size","viewSize","contentType","GawdQuilt","columns","rows","Resolution","width","height","Player","constructor","props","_props","scene","renderer","spatialPlayer","camera","clock","gawd","startAngle","targetAngle","totalAngles","aniCurTime","aniDuration","EasingFunctions","linear","t","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","spatialType","SpatialType","LOOKING_GLASS","stereoMode","StereoMode","OFF","setProps","Clock","initThree","loadGawdConfig","then","data","_this","initGawd","console","warn","playerProps","userProps","prop","Scene","WebGLRenderer","antialias","setSize","clientWidth","clientHeight","xr","enabled","appendChild","domElement","PerspectiveCamera","aspectRatio","position","add","z","setAnimationLoop","_this2","render","window","addEventListener","ev","aspect","updateProjectionMatrix","lkgAsset","filter","_this3","initMedia","asset","TextureLoader","load","tex","loadSpatialPlayer","bind","videoId","video","getElementById","createElement","id","src","crossOrigin","muted","autoplay","loop","playsInline","style","display","body","play","videoTex","VideoTexture","texture","config","QuiltConfig","SpatialPlayer","quiltColumns","quiltRows","dist","fov","Math","atan","PI","onMouseMove","response","fetch","json","e","clientX","innerWidth","quiltAngle","getDelta","round","lerp","value1","value2","amount"],"mappings":"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"}