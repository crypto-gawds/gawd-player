define(["exports","three-spatial-viewer","three"],(function(e,i,t){"use strict";function n(e,i,t,n,r,a,s){try{var o=e[a](s),l=o.value}catch(e){return void t(e)}o.done?i(l):Promise.resolve(l).then(n,r)}class r{constructor(){this.url=void 0,this.container=void 0}}e.Player=class{constructor(e){var i=this;this.props=new r,this.scene=void 0,this.renderer=void 0,this.spatialPlayer=void 0,this.camera=void 0,this.setProps(this.props,e),this.props.container?(this.initThree(),this.props.url&&this.loadGawdConfig(this.props.url).then((function(e){i.initGawd(e)}))):console.warn("No container was set")}initThree(){var e=this;this.scene=new t.Scene,this.renderer=new t.WebGLRenderer({antialias:!0}),this.renderer.setSize(this.props.container.clientWidth,this.props.container.clientHeight),this.renderer.xr.enabled=!1,this.props.container.appendChild(this.renderer.domElement),this.camera=new t.PerspectiveCamera(90,this.aspectRatio,.01,1e3),this.camera.position,this.scene.add(this.camera),this.camera.position.z=10,this.renderer.setAnimationLoop((function(){e.render()})),window.addEventListener("resize",(function(i){e.camera.aspect=e.aspectRatio,e.camera.updateProjectionMatrix(),e.renderer.setSize(e.props.container.clientWidth,e.props.container.clientHeight)})),window.addEventListener("mousemove",this.onMouseMove.bind(this))}render(){this.renderer.render(this.scene,this.camera)}onMouseMove(e){if(this.spatialPlayer){var i=this.spatialPlayer.quiltColumns*this.spatialPlayer.quiltRows,t=e.clientX/window.innerWidth;this.spatialPlayer.quiltAngle=Math.round(t*i)}}initGawd(e){console.log("Loading ".concat(e.name,"..."));var i=e.assets.filter((function(e){return"lookingglass"==e.spatial&&"FourKSquare"==e.quiltType}));this.initMedia(i[0])}initMedia(e){"image/png"==e.contentType?(console.log("Loading image: ".concat(e.url)),(new t.TextureLoader).load(e.url,function(i){this.loadSpatialPlayer(i,e)}.bind(this))):e.contentType}loadSpatialPlayer(e,t){var n=new i.QuiltConfig;n.columns=t.quilt.columns>0?t.quilt.columns:8,n.rows=t.quilt.rows>0?t.quilt.rows:6,n.width=t.viewSize.width>0?t.viewSize.width:480,n.height=t.viewSize.height>0?t.viewSize.height:640,this.spatialPlayer=new i.Player(e,null,{spatialType:i.SpatialType.LOOKING_GLASS,stereoMode:i.StereoMode.COLOR,quilt:n}),this.scene.add(this.spatialPlayer);var r=this.camera.position.z-this.spatialPlayer.position.z,a=this.aspectRatio;this.camera.fov=Math.atan(a/r)*(180/Math.PI),this.camera.updateProjectionMatrix(),console.log(this.spatialPlayer)}loadGawdConfig(e){return(i=function*(){var i=yield fetch(e);return yield i.json()},function(){var e=this,t=arguments;return new Promise((function(r,a){var s=i.apply(e,t);function o(e){n(s,r,a,o,l,"next",e)}function l(e){n(s,r,a,o,l,"throw",e)}o(void 0)}))})();var i}setProps(e,i){if(i)for(var t in i)t in e?e[t]=i[t]:console.warn("GawdViewer: Provided ".concat(t," in config but it is not a valid property and will be ignored"))}get aspectRatio(){return this.props.container.clientWidth/this.props.container.clientHeight}},e.PlayerProps=r,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=gawd-player.amd.min.js.map
