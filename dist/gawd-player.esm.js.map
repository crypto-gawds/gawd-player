{"version":3,"file":"gawd-player.esm.js","sources":["../node_modules/detect-browser/es/index.js","../src/components/player.ts"],"sourcesContent":["var __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nvar BrowserInfo = /** @class */ (function () {\n    function BrowserInfo(name, version, os) {\n        this.name = name;\n        this.version = version;\n        this.os = os;\n        this.type = 'browser';\n    }\n    return BrowserInfo;\n}());\nexport { BrowserInfo };\nvar NodeInfo = /** @class */ (function () {\n    function NodeInfo(version) {\n        this.version = version;\n        this.type = 'node';\n        this.name = 'node';\n        this.os = process.platform;\n    }\n    return NodeInfo;\n}());\nexport { NodeInfo };\nvar SearchBotDeviceInfo = /** @class */ (function () {\n    function SearchBotDeviceInfo(name, version, os, bot) {\n        this.name = name;\n        this.version = version;\n        this.os = os;\n        this.bot = bot;\n        this.type = 'bot-device';\n    }\n    return SearchBotDeviceInfo;\n}());\nexport { SearchBotDeviceInfo };\nvar BotInfo = /** @class */ (function () {\n    function BotInfo() {\n        this.type = 'bot';\n        this.bot = true; // NOTE: deprecated test name instead\n        this.name = 'bot';\n        this.version = null;\n        this.os = null;\n    }\n    return BotInfo;\n}());\nexport { BotInfo };\nvar ReactNativeInfo = /** @class */ (function () {\n    function ReactNativeInfo() {\n        this.type = 'react-native';\n        this.name = 'react-native';\n        this.version = null;\n        this.os = null;\n    }\n    return ReactNativeInfo;\n}());\nexport { ReactNativeInfo };\n// tslint:disable-next-line:max-line-length\nvar SEARCHBOX_UA_REGEX = /alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/;\nvar SEARCHBOT_OS_REGEX = /(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\\ Jeeves\\/Teoma|ia_archiver)/;\nvar REQUIRED_VERSION_PARTS = 3;\nvar userAgentRules = [\n    ['aol', /AOLShield\\/([0-9\\._]+)/],\n    ['edge', /Edge\\/([0-9\\._]+)/],\n    ['edge-ios', /EdgiOS\\/([0-9\\._]+)/],\n    ['yandexbrowser', /YaBrowser\\/([0-9\\._]+)/],\n    ['kakaotalk', /KAKAOTALK\\s([0-9\\.]+)/],\n    ['samsung', /SamsungBrowser\\/([0-9\\.]+)/],\n    ['silk', /\\bSilk\\/([0-9._-]+)\\b/],\n    ['miui', /MiuiBrowser\\/([0-9\\.]+)$/],\n    ['beaker', /BeakerBrowser\\/([0-9\\.]+)/],\n    ['edge-chromium', /EdgA?\\/([0-9\\.]+)/],\n    [\n        'chromium-webview',\n        /(?!Chrom.*OPR)wv\\).*Chrom(?:e|ium)\\/([0-9\\.]+)(:?\\s|$)/,\n    ],\n    ['chrome', /(?!Chrom.*OPR)Chrom(?:e|ium)\\/([0-9\\.]+)(:?\\s|$)/],\n    ['phantomjs', /PhantomJS\\/([0-9\\.]+)(:?\\s|$)/],\n    ['crios', /CriOS\\/([0-9\\.]+)(:?\\s|$)/],\n    ['firefox', /Firefox\\/([0-9\\.]+)(?:\\s|$)/],\n    ['fxios', /FxiOS\\/([0-9\\.]+)/],\n    ['opera-mini', /Opera Mini.*Version\\/([0-9\\.]+)/],\n    ['opera', /Opera\\/([0-9\\.]+)(?:\\s|$)/],\n    ['opera', /OPR\\/([0-9\\.]+)(:?\\s|$)/],\n    ['ie', /Trident\\/7\\.0.*rv\\:([0-9\\.]+).*\\).*Gecko$/],\n    ['ie', /MSIE\\s([0-9\\.]+);.*Trident\\/[4-7].0/],\n    ['ie', /MSIE\\s(7\\.0)/],\n    ['bb10', /BB10;\\sTouch.*Version\\/([0-9\\.]+)/],\n    ['android', /Android\\s([0-9\\.]+)/],\n    ['ios', /Version\\/([0-9\\._]+).*Mobile.*Safari.*/],\n    ['safari', /Version\\/([0-9\\._]+).*Safari/],\n    ['facebook', /FBAV\\/([0-9\\.]+)/],\n    ['instagram', /Instagram\\s([0-9\\.]+)/],\n    ['ios-webview', /AppleWebKit\\/([0-9\\.]+).*Mobile/],\n    ['ios-webview', /AppleWebKit\\/([0-9\\.]+).*Gecko\\)$/],\n    ['searchbot', SEARCHBOX_UA_REGEX],\n];\nvar operatingSystemRules = [\n    ['iOS', /iP(hone|od|ad)/],\n    ['Android OS', /Android/],\n    ['BlackBerry OS', /BlackBerry|BB10/],\n    ['Windows Mobile', /IEMobile/],\n    ['Amazon OS', /Kindle/],\n    ['Windows 3.11', /Win16/],\n    ['Windows 95', /(Windows 95)|(Win95)|(Windows_95)/],\n    ['Windows 98', /(Windows 98)|(Win98)/],\n    ['Windows 2000', /(Windows NT 5.0)|(Windows 2000)/],\n    ['Windows XP', /(Windows NT 5.1)|(Windows XP)/],\n    ['Windows Server 2003', /(Windows NT 5.2)/],\n    ['Windows Vista', /(Windows NT 6.0)/],\n    ['Windows 7', /(Windows NT 6.1)/],\n    ['Windows 8', /(Windows NT 6.2)/],\n    ['Windows 8.1', /(Windows NT 6.3)/],\n    ['Windows 10', /(Windows NT 10.0)/],\n    ['Windows ME', /Windows ME/],\n    ['Open BSD', /OpenBSD/],\n    ['Sun OS', /SunOS/],\n    ['Chrome OS', /CrOS/],\n    ['Linux', /(Linux)|(X11)/],\n    ['Mac OS', /(Mac_PowerPC)|(Macintosh)/],\n    ['QNX', /QNX/],\n    ['BeOS', /BeOS/],\n    ['OS/2', /OS\\/2/],\n];\nexport function detect(userAgent) {\n    if (!!userAgent) {\n        return parseUserAgent(userAgent);\n    }\n    if (typeof document === 'undefined' &&\n        typeof navigator !== 'undefined' &&\n        navigator.product === 'ReactNative') {\n        return new ReactNativeInfo();\n    }\n    if (typeof navigator !== 'undefined') {\n        return parseUserAgent(navigator.userAgent);\n    }\n    return getNodeVersion();\n}\nfunction matchUserAgent(ua) {\n    // opted for using reduce here rather than Array#first with a regex.test call\n    // this is primarily because using the reduce we only perform the regex\n    // execution once rather than once for the test and for the exec again below\n    // probably something that needs to be benchmarked though\n    return (ua !== '' &&\n        userAgentRules.reduce(function (matched, _a) {\n            var browser = _a[0], regex = _a[1];\n            if (matched) {\n                return matched;\n            }\n            var uaMatch = regex.exec(ua);\n            return !!uaMatch && [browser, uaMatch];\n        }, false));\n}\nexport function browserName(ua) {\n    var data = matchUserAgent(ua);\n    return data ? data[0] : null;\n}\nexport function parseUserAgent(ua) {\n    var matchedRule = matchUserAgent(ua);\n    if (!matchedRule) {\n        return null;\n    }\n    var name = matchedRule[0], match = matchedRule[1];\n    if (name === 'searchbot') {\n        return new BotInfo();\n    }\n    var versionParts = match[1] && match[1].split(/[._]/).slice(0, 3);\n    if (versionParts) {\n        if (versionParts.length < REQUIRED_VERSION_PARTS) {\n            versionParts = __spreadArrays(versionParts, createVersionParts(REQUIRED_VERSION_PARTS - versionParts.length));\n        }\n    }\n    else {\n        versionParts = [];\n    }\n    var version = versionParts.join('.');\n    var os = detectOS(ua);\n    var searchBotMatch = SEARCHBOT_OS_REGEX.exec(ua);\n    if (searchBotMatch && searchBotMatch[1]) {\n        return new SearchBotDeviceInfo(name, version, os, searchBotMatch[1]);\n    }\n    return new BrowserInfo(name, version, os);\n}\nexport function detectOS(ua) {\n    for (var ii = 0, count = operatingSystemRules.length; ii < count; ii++) {\n        var _a = operatingSystemRules[ii], os = _a[0], regex = _a[1];\n        var match = regex.exec(ua);\n        if (match) {\n            return os;\n        }\n    }\n    return null;\n}\nexport function getNodeVersion() {\n    var isNode = typeof process !== 'undefined' && process.version;\n    return isNode ? new NodeInfo(process.version.slice(1)) : null;\n}\nfunction createVersionParts(count) {\n    var output = [];\n    for (var ii = 0; ii < count; ii++) {\n        output.push('0');\n    }\n    return output;\n}\n","import * as http from 'http';\nimport { SpatialType, StereoMode, SpatialPlayer, QuiltConfig, SpatialProps } from './spatial-viewer'\nimport { WebGLRenderer, PerspectiveCamera, Scene, TextureLoader, Texture, VideoTexture } from './three'\nimport { detect } from 'detect-browser';\n\nclass Props {\n  public url: string\n  public container: HTMLElement\n  public spatialProps: SpatialProps = new SpatialProps()\n}\n\nclass Gawd {\n  public name: string\n  public assets: Array<GawdAsset>\n}\n\nclass GawdAsset {\n  public url: string\n  public spatial: string\n  public quilt: GawdQuilt\n  public quiltType: string\n  public size: Resolution\n  public viewSize: Resolution\n  public contentType: string\n}\n\nclass GawdQuilt {\n  public columns: number\n  public rows: number\n}\n\nclass Resolution {\n  public width: number\n  public height: number\n}\n\nexport { Props as PlayerProps, Gawd, GawdAsset, GawdQuilt, Resolution }\n\nexport default class Player {\n\n  private props: Props = new Props()\n  private scene: Scene\n  private renderer: WebGLRenderer\n  private spatialPlayer: SpatialPlayer\n  private camera: PerspectiveCamera\n\n  constructor(props?: Props) {\n    // Defaults\n    this.props.spatialProps.spatialType = SpatialType.LOOKING_GLASS\n    this.props.spatialProps.stereoMode  = StereoMode.COLOR\n\n    this.setProps(this.props, props)\n\n    if (this.props.container) {\n      this.initThree()\n    }\n    else {\n      console.warn(`No container was set`)\n      return;\n    }\n\n    if (this.props.url) {\n      this.loadGawdConfig(this.props.url).then(data => {\n        this.initGawd(data)\n      });\n    }\n  }\n\n  private initThree(): void {\n    this.scene = new Scene();\n\n    this.renderer = new WebGLRenderer({ antialias: true });\n    this.renderer.setSize(this.props.container.clientWidth, this.props.container.clientHeight);\n    this.renderer.xr.enabled = false;\n    this.props.container.appendChild(this.renderer.domElement);\n\n    this.camera = new PerspectiveCamera(90, this.aspectRatio, 0.01, 1000);\n    this.camera.position\n\n    this.scene.add(this.camera);\n\n    this.camera.position.z = 10;\n\n    this.renderer.setAnimationLoop(() => {\n      this.render()\n    });\n\n    window.addEventListener('resize', ev => {\n      this.camera.aspect = this.aspectRatio\n      this.camera.updateProjectionMatrix()\n      this.renderer.setSize(this.props.container.clientWidth, this.props.container.clientHeight)\n    })\n\n    window.addEventListener('mousemove', this.onMouseMove.bind(this))\n  }\n\n  private render(): void {\n    this.renderer.render(this.scene, this.camera);\n  }\n\n  private onMouseMove(e: MouseEvent): void {\n    if (this.spatialPlayer) {\n      let totalAngles = this.spatialPlayer.quiltColumns * this.spatialPlayer.quiltRows\n      let xpos = e.clientX / window.innerWidth\n      // console.log(e.clientX, window.innerWidth, xpos, totalAngles)\n      this.spatialPlayer.quiltAngle = Math.round(-xpos * totalAngles)\n    }\n  }\n\n  private initGawd(gawd: Gawd): void {\n    const result = detect()\n    let lkgAsset: GawdAsset = null;\n\n    // if firefox+windows or mobile, default to PNG\n    if ((result.name == \"firefox\" && result.os.match(/windows/i)) || \n         result.os.match(/iOS|android/i)) {\n      lkgAsset = gawd.assets.filter(a => a.spatial == 'lookingglass' && a.quiltType == 'FourKSquare' && a.contentType == \"image/png\")[0]\n    }\n    else {\n      lkgAsset = gawd.assets.filter(a => a.spatial == 'lookingglass' && a.quiltType == 'FourKSquare' && a.contentType == \"video/mp4\")[0]\n    }\n    \n    this.initMedia(lkgAsset)\n  }\n\n  private initMedia(asset: GawdAsset): void {\n    if (asset.contentType == \"image/png\") {\n      // console.log(`Loading image: ${asset.url}`)\n      const loader = new TextureLoader()\n      loader.load(asset.url, function (tex) {\n        this.loadSpatialPlayer(tex, asset)\n      }.bind(this))\n    }\n    else if (asset.contentType == 'video/mp4') {\n      let video = document.createElement('video') as HTMLVideoElement;\n      video.src = asset.url\n      video.crossOrigin = \"anonymous\"\n      video.muted = true\n      video.autoplay = true\n      video.loop = true\n      video.playsInline = true\n      video.style.display = \"none\"\n      document.body.appendChild(video);\n      video.play();\n      \n      const videoTex = new VideoTexture(video);\n      this.loadSpatialPlayer(videoTex, asset)\n    }\n  }\n\n  private loadSpatialPlayer(texture: Texture, asset: GawdAsset): void {\n    let config = new QuiltConfig();\n    config.columns = asset.quilt.columns > 0 ? asset.quilt.columns : 8\n    config.rows = asset.quilt.rows > 0 ? asset.quilt.rows : 6\n    config.width = asset.viewSize.width > 0 ? asset.viewSize.width : 480\n    config.height = asset.viewSize.height > 0 ? asset.viewSize.height : 640\n\n    this.props.spatialProps.quilt = config\n\n    this.spatialPlayer = new SpatialPlayer(texture, null, this.props.spatialProps)\n\n    this.scene.add(this.spatialPlayer)\n\n    let dist = this.camera.position.z - this.spatialPlayer.position.z;\n    let height = this.aspectRatio; // desired height to fit WHY IS THIS CALLED HEIGHT?\n    this.camera.fov = Math.atan(height / dist) * (180 / Math.PI);\n    this.camera.updateProjectionMatrix();\n\n    // console.log(this.spatialPlayer)\n  }\n\n  private async loadGawdConfig(url: string): Promise<any> {\n    const response = await fetch(url)\n    return await response.json()\n  }\n\n  private setProps(viewerProps: Props, userProps?: object): void {\n    if (!userProps) return\n\n    for (let prop in userProps) {\n      if (prop in viewerProps) {\n        viewerProps[prop] = userProps[prop]\n      } else {\n        console.warn(\n          `GawdViewer: Provided ${prop} in config but it is not a valid property and will be ignored`,\n        )\n      }\n    }\n  }\n\n  public get aspectRatio(): number {\n    return this.props.container.clientWidth / this.props.container.clientHeight\n  }\n}\n"],"names":["this","Props","url","container","spatialProps","SpatialProps","Gawd","name","assets","GawdAsset","spatial","quilt","quiltType","size","viewSize","contentType","GawdQuilt","columns","rows","Player","constructor","props","scene","renderer","spatialPlayer","camera","spatialType","SpatialType","LOOKING_GLASS","stereoMode","StereoMode","COLOR","setProps","initThree","console","warn","loadGawdConfig","then","data","initGawd","Scene","WebGLRenderer","antialias","setSize","clientWidth","clientHeight","xr","enabled","appendChild","domElement","PerspectiveCamera","aspectRatio","position","add","z","setAnimationLoop","render","window","addEventListener","ev","aspect","updateProjectionMatrix","onMouseMove","bind","e","totalAngles","quiltColumns","quiltRows","xpos","clientX","innerWidth","quiltAngle","Math","round","gawd","result","detect","lkgAsset","os","match","filter","a","initMedia","asset","loader","TextureLoader","load","tex","loadSpatialPlayer","video","document","createElement","src","crossOrigin","muted","autoplay","loop","playsInline","style","display","body","play","videoTex","VideoTexture","texture","config","QuiltConfig","width","height","SpatialPlayer","dist","fov","atan","PI","response","fetch","json","viewerProps","userProps","prop"],"mappings":"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"}